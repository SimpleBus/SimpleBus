language: php

matrix:
  include:
    - php: 7.1
      env: MODE=default
    - php: 7.2
      env: MODE=default
    - php: 7.2
      env: MODE=symfony SYMFONY_VERSION=2.7.*
    - php: 7.2
      env: MODE=symfony SYMFONY_VERSION=2.8.*
    - php: 7.2
      env: MODE=symfony SYMFONY_VERSION=3.3.*
    - php: 7.2
      env: MODE=symfony SYMFONY_VERSION=3.4.*
    - php: 7.2
      env: MODE=symfony SYMFONY_VERSION=4.0.*
    - php: 7.2
      env: MODE=doctrine DOCTRINE_VERSION=2.2.*
    - php: 7.2
      env: MODE=doctrine DOCTRINE_VERSION=2.3.*
    - php: 7.2
      env: MODE=doctrine DOCTRINE_VERSION=2.4.*
    - php: 7.2
      env: MODE=doctrine DOCTRINE_VERSION=2.5.*
    - php: 7.2
      env: MODE=doctrine DOCTRINE_VERSION=2.6.*

before_script:
  - composer self-update

script:
  - if [[ "$MODE" == "doctrine" ]]; then cd $TRAVIS_BUILD_DIR/Bridge/DoctrineDBALBridge && composer require --no-update doctrine/orm:${DOCTRINE_VERSION} && composer install --prefer-dist && vendor/bin/phpunit; fi;
  - if [[ "$MODE" == "doctrine" ]]; then cd $TRAVIS_BUILD_DIR/Bridge/DoctrineORMBridge && composer require --no-update doctrine/orm:${DOCTRINE_VERSION} && composer install --prefer-dist && vendor/bin/phpunit; fi;
  - if [[ "$MODE" == "default" ]]; then cd $TRAVIS_BUILD_DIR/Bridge/JMSSerializerBridge && composer install --prefer-dist && vendor/bin/phpunit; fi;
