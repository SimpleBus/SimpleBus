language: php

php:
  - 7.1
  - 7.2

jobs:
  include:
    - stage: Bridge/DoctrineDBALBridge
      env:
        - DOCTRINE_VERSION: 2.2.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/DoctrineDBALBridge
      env:
        - DOCTRINE_VERSION: 2.3.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/DoctrineDBALBridge
      env:
        - DOCTRINE_VERSION: 2.4.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/DoctrineDBALBridge
      env:
        - DOCTRINE_VERSION: 2.5.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/DoctrineORMBridge
      env:
        - DOCTRINE_VERSION: 2.2.*
        - DOCTRINE_VERSION: 2.3.*
        - DOCTRINE_VERSION: 2.4.*
        - DOCTRINE_VERSION: 2.5.*
      before_script:
        - cd Bridge/DoctrineORMBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit
