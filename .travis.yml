language: php

jobs:
  include:
    # PHP 7.1
    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.1
      env: DOCTRINE_VERSION=2.2.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.1
      env: DOCTRINE_VERSION=2.3.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.1
      env: DOCTRINE_VERSION=2.4.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.1
      env: DOCTRINE_VERSION=2.5.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    # PHP 7.2
    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.2
      env: DOCTRINE_VERSION=2.2.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.2
      env: DOCTRINE_VERSION=2.3.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.2
      env: DOCTRINE_VERSION=2.4.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit

    - stage: Bridge/Doctrine-DBAL-Bridge
      php: 7.2
      env: DOCTRINE_VERSION=2.5.*
      before_script:
        - cd Bridge/DoctrineDBALBridge
        - composer self-update
        - composer require --no-update doctrine/orm:${DOCTRINE_VERSION}
      install:
        - composer install --prefer-dist
      script:
        - vendor/bin/phpunit
